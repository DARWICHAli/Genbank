package Parser;

import java.io.BufferedReader;
import java.io.IOException;
import java.net.MalformedURLException;
import java.net.URL;
import Utils.*;

public class CDSDownloader extends Downloader {
	private static final String REQUEST = "db=nuccore&retmode=raw&withparts=on&basic_feat=on";
	private final String ID;
	private final StringBuilder DATA;
	
	public CDSDownloader(String _id, StringBuilder D) {
        ID = _id;
        DATA = D;
    }
	
	public void download() throws IOException {
        final BufferedReader reader;
        URL url = null;

            url = getURL();
            reader = get(url);
            for (int c; (c = reader.read()) != -1; ) {
                DATA.append((char) c);
            }
    }
	
	private URL getURL() throws MalformedURLException {
        final String urlStr = String.format("%s?%s&id=%s", Utils.getCDSBaseUrl(), REQUEST, ID);

        final URL res;
        try {
            res = new URL(urlStr);
        } catch (MalformedURLException e) {
            // Log.warning("Unable to create an url : " + urlStr);
            // Log.exception(e);
            throw e;
        }

        return res;
    }
}
